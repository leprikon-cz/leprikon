{% extends 'leprikon/default.html' %}
{% load i18n cms_tags leprikon_tags sekizai_tags static %}

{% block content %}

<h1>{% block title %}{% trans 'Log in' %}{% endblock %}</h1>

<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingPassword" data-toggle="collapse" data-parent="#accordion" href="#collapsePassword" aria-expanded="{% if form.used_form == form.email_form %}false{% else %}true{% endif %}" aria-controls="collapsePassword">
      <h3 class="panel-title">
        {% trans 'Log in with username and password' %}
      </h3>
    </div>
    <div id="collapsePassword" class="panel-collapse collapse{% if form.used_form != form.email_form %} in{% endif %}" role="tabpanel" aria-labelledby="headingPassword">
      <div class="panel-body">
        {% if form.used_form == form.password_form %}
        {% if form.errors %}
          <div class="alert alert-danger" role="alert">{% trans 'Please correct the highlighted errors below.' %}</div>
        {% endif %}
        {% for error in form.non_field_errors %}
          <div class="alert alert-danger" role="alert">{{ error }}</div>
        {% endfor %}
        {% endif %}
        <form action="" method="post">{% csrf_token %}
          {% for item in form.password_form %}
            {% include 'leprikon/form_item_fullwidth.html' %}
          {% endfor %}
          <div class="form-group">
            <button class="btn btn-primary" type="submit">{% trans 'Log in' %}</button>
            <a class="btn" href="{% url 'leprikon:user_create' %}?{% param_back %}={% url_back %}">
              {% trans 'Create account' %}
            </a>
            <a class="btn" href="{% url 'leprikon:password_reset' %}?{% param_back %}={% url_back %}">
              {% trans 'Reset password' %}
            </a>
          </div>
        </form>
        {% if backends.not_associated %}
        <hr />
        <div class="form-group">
          {% if 'google-oauth2' in backends.not_associated %}
          <a class="btn btn-social btn-google" style="text-align: center; padding-right: 44px" href="{% url 'social:begin' 'google-oauth2' %}?next={% url_back %}">
            <i class="fa fa-google"></i>
            {% trans 'Log in with Google' %}
          </a>
          {% endif %}
          {% if 'facebook' in backends.not_associated %}
          <a class="btn btn-social btn-facebook" style="text-align: center; padding-right: 44px" href="{% url 'social:begin' 'facebook' %}?next={% url_back %}">
            <i class="fa fa-facebook"></i>
            {% trans 'Log in with Facebook' %}
          </a>
          {% endif %}
        </div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading" role="tab" id="headingEmail" data-toggle="collapse" data-parent="#accordion" href="#collapseEmail" aria-expanded="{% if form.used_form == form.email_form %}true{% else %}false{% endif %}" aria-controls="collapseEmail">
      <h3 class="panel-title">
        {% trans 'Log in with verified e-mail' %}
      </h3>
    </div>
    <div id="collapseEmail" class="panel-collapse collapse{% if form.used_form == form.email_form %} in{% endif %}" role="tabpanel" aria-labelledby="headingEmail">
      <div class="panel-body">
        {% if form.used_form == form.email_form %}
        {% if form.errors %}
            <div class="alert alert-danger" role="alert">{% trans 'Please correct the highlighted errors below.' %}</div>
        {% endif %}
        {% for error in form.non_field_errors %}
            <div class="alert alert-danger" role="alert">{{ error }}</div>
        {% endfor %}
        {% endif %}
        <form action="" method="post">{% csrf_token %}
            {% for item in form.email_form %}
                {% include 'leprikon/form_item_fullwidth.html' %}
            {% endfor %}
            <div class="form-group">
                <button class="btn btn-block btn-primary" type="submit">{% trans 'Log in' %}</button>
            </div>
        </form>
      </div>
    </div>
  </div>
</div>

{% addtoblock 'css' %}
{{ form.media.css }}
{% endaddtoblock %}

{% addtoblock 'js' %}
{{ form.media.js }}
{% endaddtoblock %}

{% endblock %}
